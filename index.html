<!DOCTYPE html>
<html lang="en">
  <head>
    <title>RInAppMessaging  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
  </head>
  <body>
    <a title="RInAppMessaging  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html">RInAppMessaging 0.1.0 Docs</a> (36% documented)</p>
        <p class="header-right"><a href="https://github.com/rakutentech/ios-inappmessaging"><img src="img/gh.png"/>View on GitHub</a></p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html">RInAppMessaging Reference</a>
        <img id="carat" src="img/carat.png" />
        RInAppMessaging  Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/AppStartEvent.html">AppStartEvent</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/CustomAttribute.html">CustomAttribute</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/CustomEvent.html">CustomEvent</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Event.html">Event</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes.html#/c:@M@RInAppMessaging@objc(cs)IAMPreference">IAMPreference</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/IAMPreferenceBuilder.html">IAMPreferenceBuilder</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/LoginSuccessfulEvent.html">LoginSuccessfulEvent</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/PurchaseSuccessfulEvent.html">PurchaseSuccessfulEvent</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/RInAppMessaging.html">RInAppMessaging</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Enums.html">Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Enums/Identification.html">Identification</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/RInAppMessagingErrorDelegate.html">RInAppMessagingErrorDelegate</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            
            <p><a href="https://travis-ci.org/rakutentech/ios-inappmessaging"><img src="https://travis-ci.org/rakutentech/ios-inappmessaging.svg?branch=master" alt="Build Status"></a>
<a href="https://codecov.io/gh/rakutentech/ios-inappmessaging"><img src="https://codecov.io/gh/rakutentech/ios-inappmessaging/branch/master/graph/badge.svg" alt="codecov"></a></p>
<h1 id='rinappmessaging' class='heading'>RInAppMessaging</h1>

<p>InAppMessaging allows app developers to easily configure and display notifications within their app.</p>
<h1 id='strong-how-to-install-strong' class='heading'><strong>How to install</strong></h1>

<p>InAppMessaging SDK is distributed as a Cocoapod.<br>
More information on installing pods: <a href="https://guides.cocoapods.org/using/getting-started.html">https://guides.cocoapods.org/using/getting-started.html</a></p>

<p>1) Include the following in your application&rsquo;s Podfile</p>
<pre class="highlight ruby"><code><span class="n">pod</span> <span class="s1">'InAppMessaging'</span> <span class="ss">:git</span> <span class="o">=&gt;</span> <span class="s1">'https://github.com/rakutentech/ios-inappmessaging.git'</span>
</code></pre>

<p>2) Run the following in the terminal</p>
<pre class="highlight plaintext"><code>pod install
</code></pre>
<h1 id='strong-configuring-strong' class='heading'><strong>Configuring</strong></h1>

<p><strong>Note:</strong> Currently we do not host any public APIs but you can create your own APIs and configure the SDK to use those.</p>

<p>1)  To use the module you must set the following values in your app&rsquo;s <code>Info.plist</code>:</p>

<table><thead>
<tr>
<th style="text-align: center">Key</th>
<th style="text-align: center">Value</th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: center"><code>InAppMessagingSubscriptionID</code></td>
<td style="text-align: center">your_subscription_key</td>
</tr>
<tr>
<td style="text-align: center"><code>InAppMessagingConfigurationURL</code></td>
<td style="text-align: center">Endpoint for fetching the configuration</td>
</tr>
</tbody></table>
<h1 id='strong-using-the-sdk-strong' class='heading'><strong>Using the SDK</strong></h1>

<p>The SDK provides 3 public methods for the host applications to use:</p>

<ol>
<li><code>configure()</code></li>
<li><code>logEvent()</code></li>
<li><code>registerPreference()</code></li>
</ol>
<h3 id='strong-configure-strong' class='heading'><strong>configure()</strong></h3>

<p>This method is called to initialize the SDK and should be placed in your AppDelegate&rsquo;s <code>didFinishLaunchingWithOptions</code>.</p>

<p><strong>Swift</strong></p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">InAppMessaging</span>

<span class="kd">func</span> <span class="nf">application</span><span class="p">(</span><span class="n">_</span> <span class="nv">application</span><span class="p">:</span> <span class="kt">UIApplication</span><span class="p">,</span> <span class="n">didFinishLaunchingWithOptions</span> <span class="nv">launchOptions</span><span class="p">:</span> <span class="p">[</span><span class="kt">UIApplicationLaunchOptionsKey</span><span class="p">:</span> <span class="kt">Any</span><span class="p">]?)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
    <span class="kt">InAppMessaging</span><span class="o">.</span><span class="nf">configure</span><span class="p">()</span>
    <span class="k">return</span> <span class="kc">true</span>
<span class="p">}</span>
</code></pre>

<p><strong>Objective-C</strong></p>
<pre class="highlight swift"><code><span class="kd">@import</span> <span class="kt">InAppMessaging</span><span class="p">;</span>

<span class="o">-</span> <span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nv">application</span><span class="p">:(</span><span class="kt">UIApplication</span> <span class="o">*</span><span class="p">)</span><span class="n">application</span> <span class="nv">didFinishLaunchingWithOptions</span><span class="p">:(</span><span class="kt">NSDictionary</span> <span class="o">*</span><span class="p">)</span><span class="n">launchOptions</span>
<span class="p">{</span>
    <span class="p">[</span><span class="kt">InAppMessaging</span> <span class="n">configure</span><span class="p">];</span>
    <span class="k">return</span> <span class="kt">YES</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
<h3 id='strong-logevent-strong' class='heading'><strong>logEvent()</strong></h3>

<p>This method is provided for the host application to log and save events. These events will be used to match campaign triggers.</p>

<p><strong>The method signature is</strong></p>
<pre class="highlight swift"><code><span class="kd">func</span> <span class="nf">logEvent</span><span class="p">(</span><span class="n">_</span> <span class="nv">event</span><span class="p">:</span> <span class="kt">Event</span><span class="p">)</span>
</code></pre>

<p>InAppMessaging provides three pre-defined event types and a custom event type:</p>

<ol>
<li><code><a href="Classes/AppStartEvent.html">AppStartEvent</a></code> - This event should be logged when the application is considered started by the host app. E.G AppDelegate&rsquo;s didFinishLaunchingWithOptions.</li>
<li><code><a href="Classes/LoginSuccessfulEvent.html">LoginSuccessfulEvent</a></code> - This event should be logged whenever the user logs in successfully.</li>
<li><code><a href="Classes/PurchaseSuccessfulEvent.html">PurchaseSuccessfulEvent</a></code> - This event should be logged whenever a successful purchase occurs and has several pre-defined properties – purchase amount, number of items, currency code and item list.</li>
<li><code><a href="Classes/CustomEvent.html">CustomEvent</a></code> - This event is created by the host app developers and can take in any event name and a list of custom attributes.</li>
</ol>

<p><strong>Swift</strong></p>
<pre class="highlight swift"><code><span class="c1">// App start event.</span>
<span class="kt">InAppMessaging</span><span class="o">.</span><span class="nf">logEvent</span><span class="p">(</span><span class="kt">AppStartEvent</span><span class="p">())</span>

<span class="c1">// Purchase successful event.</span>
<span class="k">let</span> <span class="nv">purchaseEvent</span> <span class="o">=</span> <span class="kt">PurchaseSuccessfulEvent</span><span class="p">()</span>
<span class="n">purchaseEvent</span><span class="o">.</span><span class="nf">setPurchaseAmount</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="n">purchaseEvent</span><span class="o">.</span><span class="nf">setItemList</span><span class="p">([</span><span class="s">"box"</span><span class="p">,</span> <span class="s">"hammer"</span><span class="p">])</span>
<span class="n">purchaseEvent</span><span class="o">.</span><span class="nf">setCurrencyCode</span><span class="p">(</span><span class="s">"USD"</span><span class="p">)</span>

<span class="kt">InAppMessaging</span><span class="o">.</span><span class="nf">logEvent</span><span class="p">(</span><span class="n">purchaseEvent</span><span class="p">)</span>

<span class="c1">// Login event.</span>
<span class="kt">InAppMessaging</span><span class="o">.</span><span class="nf">logEvent</span><span class="p">(</span><span class="kt">LoginSuccessfulEvent</span><span class="p">())</span>

<span class="c1">// Custom event.</span>
<span class="k">let</span> <span class="nv">stringAttribute</span> <span class="o">=</span> <span class="kt">CustomAttribute</span><span class="p">(</span><span class="nv">withKeyName</span><span class="p">:</span> <span class="s">"userResponse"</span><span class="p">,</span> <span class="nv">withStringValue</span><span class="p">:</span> <span class="s">"hi"</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">intAttribute</span> <span class="o">=</span> <span class="kt">CustomAttribute</span><span class="p">(</span><span class="nv">withKeyName</span><span class="p">:</span> <span class="s">"numberOfClicks"</span><span class="p">,</span> <span class="nv">withIntValue</span><span class="p">:</span> <span class="mi">100</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">boolAttribute</span> <span class="o">=</span> <span class="kt">CustomAttribute</span><span class="p">(</span><span class="nv">withKeyName</span><span class="p">:</span> <span class="s">"didNavigateToPage"</span><span class="p">,</span> <span class="nv">withBoolValue</span><span class="p">:</span> <span class="kc">false</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">doubleAttribute</span> <span class="o">=</span> <span class="kt">CustomAttribute</span><span class="p">(</span><span class="nv">withKeyName</span><span class="p">:</span> <span class="s">"percentageOfCompletion"</span><span class="p">,</span> <span class="nv">withDoubleValue</span><span class="p">:</span> <span class="mf">55.0</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">timeAttribute</span> <span class="o">=</span> <span class="kt">CustomAttribute</span><span class="p">(</span><span class="nv">withKeyName</span><span class="p">:</span> <span class="s">"timeOfCompletion"</span><span class="p">,</span> <span class="nv">withTimeInMilliValue</span><span class="p">:</span> <span class="mi">32423424</span><span class="p">)</span>

<span class="k">let</span> <span class="nv">attriList</span> <span class="o">=</span> <span class="p">[</span><span class="n">stringAttribute</span><span class="p">,</span> <span class="n">intAttribute</span><span class="p">,</span> <span class="n">boolAttribute</span><span class="p">,</span> <span class="n">doubleAttribute</span><span class="p">,</span> <span class="n">timeAttribute</span><span class="p">]</span>

<span class="kt">InAppMessaging</span><span class="o">.</span><span class="nf">logEvent</span><span class="p">(</span><span class="kt">CustomEvent</span><span class="p">(</span><span class="nv">withName</span><span class="p">:</span> <span class="s">"any_event_name_here"</span><span class="p">,</span> <span class="nv">withCustomAttributes</span><span class="p">:</span> <span class="n">attriList</span><span class="p">))</span>
</code></pre>

<p><strong>Objective-C</strong></p>
<pre class="highlight swift"><code><span class="c1">// App start event.</span>
<span class="p">[</span><span class="kt">InAppMessaging</span> <span class="nv">logEvent</span><span class="p">:[[</span><span class="kt">AppStartEvent</span> <span class="n">alloc</span><span class="p">]</span> <span class="kd">init</span><span class="p">]];</span> 

<span class="c1">// Login event.</span>
<span class="p">[</span><span class="kt">InAppMessaging</span> <span class="nv">logEvent</span><span class="p">:[[</span><span class="kt">LoginSuccessfulEvent</span> <span class="n">alloc</span><span class="p">]</span> <span class="kd">init</span><span class="p">]];</span>

<span class="c1">// Custom event.</span>
<span class="kt">CustomAttribute</span><span class="o">*</span> <span class="n">stringAttribute</span> <span class="o">=</span> <span class="p">[[</span><span class="kt">CustomAttribute</span> <span class="n">alloc</span><span class="p">]</span> <span class="nv">initWithKeyName</span><span class="p">:</span><span class="s">@"userResponse"</span> <span class="nv">withStringValue</span><span class="p">:</span><span class="s">@"hi"</span><span class="p">];</span>
<span class="kt">CustomAttribute</span><span class="o">*</span> <span class="n">intAttribute</span> <span class="o">=</span> <span class="p">[[</span><span class="kt">CustomAttribute</span> <span class="n">alloc</span><span class="p">]</span> <span class="nv">initWithKeyName</span><span class="p">:</span><span class="s">@"numberOfClicks"</span> <span class="nv">withIntValue</span><span class="p">:</span><span class="mi">100</span><span class="p">];</span>
<span class="kt">CustomAttribute</span><span class="o">*</span> <span class="n">boolAttribute</span> <span class="o">=</span> <span class="p">[[</span><span class="kt">CustomAttribute</span> <span class="n">alloc</span><span class="p">]</span> <span class="nv">initWithKeyName</span><span class="p">:</span><span class="s">@"didUserNavigateToPage"</span> <span class="nv">withBoolValue</span><span class="p">:</span><span class="kt">NO</span><span class="p">];</span>
<span class="kt">CustomAttribute</span><span class="o">*</span> <span class="n">doubleAttribute</span> <span class="o">=</span> <span class="p">[[</span><span class="kt">CustomAttribute</span> <span class="n">alloc</span><span class="p">]</span> <span class="nv">initWithKeyName</span><span class="p">:</span><span class="s">@"percentageOfCompletion"</span> <span class="nv">withDoubleValue</span><span class="p">:</span><span class="mf">55.0</span><span class="p">];</span>
<span class="kt">CustomAttribute</span><span class="o">*</span> <span class="n">timeAttribute</span> <span class="o">=</span> <span class="p">[[</span><span class="kt">CustomAttribute</span> <span class="n">alloc</span><span class="p">]</span> <span class="nv">initWithKeyName</span><span class="p">:</span><span class="s">@"timeOfCompletion"</span> <span class="nv">withTimeInMilliValue</span><span class="p">:</span><span class="mi">23424141</span><span class="p">];</span>

<span class="kt">NSArray</span><span class="o">*</span> <span class="n">attriList</span> <span class="o">=</span> <span class="err">@</span><span class="p">[</span><span class="n">stringAttribute</span><span class="p">,</span> <span class="n">intAttribute</span><span class="p">,</span> <span class="n">boolAttribute</span><span class="p">,</span> <span class="n">doubleAttribute</span><span class="p">,</span> <span class="n">timeAttribute</span><span class="p">];</span>
<span class="kt">CustomEvent</span><span class="o">*</span> <span class="n">customEvent</span> <span class="o">=</span> <span class="p">[[</span><span class="kt">CustomEvent</span> <span class="n">alloc</span><span class="p">]</span> <span class="nv">initWithName</span><span class="p">:</span><span class="s">@"any_event_name_here"</span> <span class="nv">withCustomAttributes</span><span class="p">:</span> <span class="n">attriList</span><span class="p">];</span>
<span class="p">[</span><span class="kt">InAppMessaging</span> <span class="nv">logEvent</span><span class="p">:</span><span class="n">customEvent</span><span class="p">];</span>
</code></pre>
<h3 id='strong-registerpreference-strong' class='heading'><strong>registerPreference()</strong></h3>

<p>A preference is what will allow InAppMessaging to identify users for targeting and segmentation. At the moment, IAM will take in any of the following identifiers:</p>

<ol>
<li>RakutenID</li>
<li>UserID - The ID when registering a Rakuten account. e.g. an email address</li>
<li>AccessToken - This is the token provided by the internal RAuthentication SDK as the &ldquo;accessToken&rdquo; value</li>
</ol>

<p>To help IAM identify users, please set a new preference every time a user changes their login state i.e. when they log in or log out.<br>
Not all identifiers have to be provided.</p>

<p><strong>Objective-C</strong></p>
<pre class="highlight swift"><code><span class="kt">IAMPreference</span><span class="o">*</span> <span class="n">preference</span> <span class="o">=</span> <span class="p">[[[[[[</span><span class="kt">IAMPreferenceBuilder</span> <span class="n">alloc</span><span class="p">]</span> <span class="kd">init</span><span class="p">]</span>
    <span class="nv">setUserId</span><span class="p">:</span><span class="s">@"testaccount@gmail.com"</span><span class="p">]</span>
    <span class="nv">setRakutenId</span><span class="p">:</span><span class="s">@"testaccount"</span><span class="p">]</span>
    <span class="nv">setAccessToken</span><span class="p">:</span><span class="s">@"27364827346"</span><span class="p">]</span>
    <span class="n">build</span><span class="p">];</span>

<span class="p">[</span><span class="kt">InAppMessaging</span> <span class="nv">registerPreference</span><span class="p">:</span><span class="n">preference</span><span class="p">];</span>
</code></pre>
<h2 id='strong-custom-events-strong' class='heading'><strong>Custom Events</strong></h2>

<p>As shown in the example above for event logging, InAppMessaging also supports custom event. Custom events are events with an unique name and a list of attributes associated with them.</p>

<p>In order to properly utilize custom events, the person creating the campaign must sync up with the host app developers to ensure that both the event name and attribute name/value exactly match exactly - note that these are case-sensitive.</p>

<p>From the dashboard side, you will have the ability to also add an operator. The following operators are supported:<br>
1) <code>EQUALS</code> - The values should be equal. In terms of timeInMillis, there will be a tolerance of 1000 milliseconds. E.G 1001 and 500 milliseconds will be considered equal.<br>
2) <code>IS_NOT_EQUAL</code> - The values should be different. In terms of timeInMillis, there will be a tolerance of 1000 milliseconds. E.G 1001 and 500 milliseconds will be considered equal.<br>
3) <code>GREATER_THAN</code> - The event attribute value is greater than the campaign&rsquo;s trigger value. Applies to only arithmetic types.<br>
4) <code>LESS_THAN</code> - The event attribute value is less than the campaign&rsquo;s trigger value. Applies to only arithmetic types.<br>
5) <code>IS_BLANK</code> - The attribute value is empty. Applies to only String type only.<br>
6) <code>IS_NOT_BLANK</code> - The attribute value is not empty. Applied to String type only.<br>
7) <code>MATCHES_REGEX</code> - The attribute value matches the regular expression. Applies to only String type.<br>
8) <code>DOES_NOT_MATCH_REGEX</code> - The attribute value does not match the regular expression. Applies to only String type string.</p>

<p><em>Note:</em> When comparing date as timeInMillis values, there will be a tolerance of 1000 milliseconds. This means that comparisons using any relevant operator types will have a leniency of 1 second e.g. comparing 300ms and 600ms with the <code>EQUALS</code> operator will return <code>true</code> and comparing 300 and 1400 will return <code>false</code>.</p>

<p>From the SDK side, host app developers will be able to log custom events as shown in the examples above. When the event matching process happens, note that the attributes of the event logged by the host app will be compared against the campaign&rsquo;s trigger attribute value e.g. if the trigger attribute value is an integer of 5 with an operator type of <code>GREATER_THAN</code>, and the attribute value of the event logged is an integer 10, then the 10 will be successfully matched against the 5 with a <code>GREATER_THAN</code> operator (i.e. 10 &gt; 5).</p>

          </section>
        </section>
        <section id="footer">
          <p>&copy; 2020 <a class="link" href="https://github.com/rakutentech/ios-inappmessaging" target="_blank" rel="external">Rakuten</a>. All rights reserved. (Last updated: 2020-03-26)</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.13.1</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
